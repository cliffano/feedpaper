<div class="app-page" data-page="feedpaper">
  <div class="app-topbar black">
    <h1 class="app-title"><strong>Feedpaper</strong></h1>
  </div>
  <div class="app-content">
    <ul class="app-list">
      {foreach category in categories}
        <li class="app-button" data-target="category-{slug(category.title)}" data-target-args='{{ "id": "{slug(category.title)}", "title": "{category.title}" }}'>{category.title}</li>
      {end}
    </ul>
    {include('footer.html')}
  </div>
</div>

<div class="app-page" data-page="feedpaper-article">
  <div class="app-topbar black">
    <div class="app-button left hack-data-back" data-target="feedpaper"></div>
    <h1 class="app-title"><strong class="app-title-hook"></strong></h1>
  </div>
  <div class="app-content">
    <div id="article">
      Loading article...
    </div>
    {include('footer.html')}
  </div>
</div>

{foreach category in categories}
  <div class="app-page" data-page="category-{slug(category.title)}">
    <div class="app-topbar black">
      <div class="app-button left" data-back></div>
      <h1 class="app-title"><strong>{category.title}</strong></h1>
    </div>
    <div class="app-content">
      <ul class="app-list">
        {foreach feed in category.feeds}
          <li class="app-button" data-target="feed" data-target-args='{{ "id": "{slug(feed.title)}", "title": "{feed.title}", "categoryId": "{slug(category.title)}", "categoryTitle": "{category.title}" }}'>{feed.title}</li>
        {end}
      </ul>
      {include('footer.html')}
    </div>
  </div>
{end}

<div class="app-page" data-page="feed">
  <div class="app-topbar black">
    <div class="app-button left" data-back></div>
    <h1 class="app-title"><strong class="app-title-hook"></strong></h1>
  </div>
  <div class="app-content">
    <ul class="app-list">
      <li class="app-button">Loading feed...</li>
    </ul>
    {include('footer.html')}
  </div>
</div>

<div class="app-page" data-page="article">
  <div class="app-topbar black">
    <div class="app-button left" data-back></div>
    <h1 class="app-title"><strong class="app-title-hook"></strong></h1>
  </div>
  <div class="app-content">
    <div id="article">
      Loading article...
    </div>
    {include('footer.html')}
  </div>
</div>

<script type="text/javascript">
$(document).ready(function () {{
  // App.load('feedpaper-article', {{ url: '{{article.url}}' }}, function () {{
  //   console.log('FeedPaper application loaded on article page');
  // }});
  try {{
    App.restore();
    console.log('FeedPaper application restored');
  }} catch (err) {{
    App.load('feedpaper', function () {{
      console.log('FeedPaper application loaded on home page');
    }});
  }}
}});
</script>
